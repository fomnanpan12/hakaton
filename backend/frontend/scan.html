<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scan QR Code</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

      <!-- Navigation -->
 <header class="navbar">
  <div class="container nav-content">
    <!-- Logo -->
    <div class="logo" onclick="window.location.href='/'">Track2Chain</div>

    <!-- Navigation Links -->
    <nav class="nav-center">
      <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/scan.html">Scan</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="/contact.html">Contact</a></li>
      </ul>
    </nav>

    <!-- Buttons -->
    <div class="auth-buttons">
      <a href="/auth.html" class="nav-btn">Sign In</a>
    </div>

    <!-- Hamburger for Mobile -->
    <button class="hamburger" id="navToggle" aria-label="Toggle menu" aria-expanded="false">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
  </div>
</header>

  <h2 style="text-align: center;">Scan a QR Code</h2>
  <div id="reader"></div>
  <p id="result"></p>


  <footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-main">
        <div class="footer-brand">
          <h3>Track2Chain</h3>
          <p>Securing supply chains with blockchain technology</p>
        </div>
        
        <div class="footer-links">
          <div class="footer-column">
            <h4>Product</h4>
            <ul>
              <li><a href="#features">Features</a></li>
              <li><a href="#how-it-works">How It Works</a></li>
              <li><a href="#pricing">Pricing</a></li>
            </ul>
          </div>
          
          <div class="footer-column">
            <h4>Company</h4>
            <ul>
              <li><a href="#about">About Us</a></li>
              <li><a href="#contact">Contact</a></li>
              <li><a href="#careers">Careers</a></li>
            </ul>
          </div>
          
          <div class="footer-column">
            <h4>Resources</h4>
            <ul>
              <li><a href="#docs">Documentation</a></li>
              <li><a href="#support">Support</a></li>
              <li><a href="#blog">Blog</a></li>
            </ul>
          </div>
        </div>

        <div class="footer-cta">
          <h4>Ready to Get Started?</h4>
          <p>Join thousands of companies securing their supply chains</p>
          <button class="cta-button">Start Free Trial</button>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>Â© 2025 Track2Chain. All rights reserved.</p>
        <div class="footer-social">
          <a href="#" aria-label="Twitter">
            <svg viewBox="0 0 24 24">
              <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/>
            </svg>
          </a>
          <a href="#" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24">
              <path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"/>
              <circle cx="4" cy="4" r="2"/>
            </svg>
          </a>
          <a href="#" aria-label="GitHub">
            <svg viewBox="0 0 24 24">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0020 4.77 5.07 5.07 0 0019.91 1S18.73.65 16 2.48a13.38 13.38 0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 005 4.77a5.44 5.44 0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 009 18.13V22"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>

  <script>
    const DOMAIN = "https://hakaton-1lu4.onrender.com"; // change to your real domain if deployed
    let lastScanned = "";   // track last scanned QR
    let scannedOnce = false; // prevent multiple tab opens

    function handleResult(decodedText) {
        document.getElementById("result").innerText = "Scanned: " + decodedText;

        if (!scannedOnce && decodedText.startsWith(DOMAIN)) {
        scannedOnce = true; // block future opens
        window.open(decodedText, "_blank");
        } else if (!decodedText.startsWith(DOMAIN)) {
        alert("Invalid QR: " + decodedText);
        }
    }

    // Live camera scanning
    function onScanSuccess(decodedText) {
        if (decodedText !== lastScanned) {
        lastScanned = decodedText; // ignore duplicate scans
        handleResult(decodedText);
        }
    }

    function onScanError(errorMessage) {
        // ignore errors
    }

    let scanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 });
    scanner.render(onScanSuccess, onScanError);

    // Upload file scanning
    document.getElementById("qr-input-file").addEventListener("change", async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const qrCodeScanner = new Html5Qrcode("reader-upload");
        try {
        const result = await qrCodeScanner.scanFile(file, true);
        handleResult(result);
        } catch (err) {
        alert("Could not scan file: " + err);
        }
    });
  </script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.querySelector(".navbar");
    const toggle = document.getElementById("navToggle");

    if (toggle && header) {
      toggle.addEventListener("click", () => {
        const isOpen = header.classList.toggle("open");
        toggle.setAttribute("aria-expanded", isOpen ? "true" : "false");
      });
    }
  });
  </script>



</body>
</html>
